<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-security">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="alternate" type="application/rss+xml" href="/gsudo/blog/rss.xml" title="gsudo (sudo for windows) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/gsudo/blog/atom.xml" title="gsudo (sudo for windows) Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RLH6G3T39R"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RLH6G3T39R",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="gsudo (sudo for windows)" href="/gsudo/opensearch.xml"><title data-rh="true">Security Considerations | gsudo (sudo for windows)</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://gerardog.github.io/gsudo/docs/security"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="windows sudo, powershell sudo, sudo for windows, sudo for powershell"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Security Considerations | gsudo (sudo for windows)"><meta data-rh="true" name="description" content="Why Windows doesn&#x27;t have a sudo command?"><meta data-rh="true" property="og:description" content="Why Windows doesn&#x27;t have a sudo command?"><link data-rh="true" rel="icon" href="/gsudo/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://gerardog.github.io/gsudo/docs/security"><link data-rh="true" rel="alternate" href="https://gerardog.github.io/gsudo/docs/security" hreflang="en"><link data-rh="true" rel="alternate" href="https://gerardog.github.io/gsudo/docs/security" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://48THU2IKHD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/gsudo/assets/css/styles.a5043e5f.css">
<link rel="preload" href="/gsudo/assets/js/runtime~main.743845d5.js" as="script">
<link rel="preload" href="/gsudo/assets/js/main.4cd861a1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/gsudo/"><div class="navbar__logo"><img src="/gsudo/img/AnimatedPrompt.gif" alt="gsudo Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/gsudo/img/AnimatedPrompt.gif" alt="gsudo Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">gsudo</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/gsudo/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/gsudo/docs/install">Install</a><a class="navbar__item navbar__link" href="/gsudo/sponsor">Sponsor</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gerardog/gsudo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/gsudo/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/gsudo/docs/install">How to Install</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/gsudo/docs/usage">How to Use</a><button aria-label="Toggle the collapsible sidebar category &#x27;How to Use&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/gsudo/docs/credentials-cache">Credentials Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/gsudo/docs/security">Security Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/gsudo/docs/how-it-works">How it works</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/gsudo/docs/tips/mixed-elevation-in-windows-terminal">Tips &amp; Hacks</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/gsudo/docs/troubleshooting">Troubleshooting</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/gsudo/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Security Considerations</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-windows-doesnt-have-a-sudo-command">Why Windows doesn&#x27;t have a <code>sudo</code> command?<a class="hash-link" href="#why-windows-doesnt-have-a-sudo-command" title="Direct link to heading">​</a></h2><p>To answer this question, we first have to take a look back at the history.</p><p>In August 2002, Chris Paget released a white paper describing a form of attack against event-driven systems that he termed Shatter Attack. It allowed processes in the same session to bypass security restrictions by abusing Windows Message loop.</p><p>Microsoft response was to add &quot;User Interface Privilege Isolation&quot; (UIPI) and the &quot;User Access Control&quot; (UAC) popup to the next mayor release: Windows Vista. Privileged processes would then run &quot;elevated&quot; at high integrity level, out of reach of processes at lower, non-admin, levels.</p><p>I assume that at this point Microsoft decided not to make a <code>sudo</code> tool for windows. It would be an unwanted bridge between two worlds that intended to isolate.</p><p>But that insulation quickly proved weak. Let me <a href="https://devblogs.microsoft.com/oldnewthing/20160816-00/?p=94105" target="_blank" rel="noopener noreferrer">quote Raymond Chen from Microsoft</a>:</p><blockquote><p>There’s a setting that lets you specify how often you want to be prompted by UAC. You can set any of four levels:</p><ul><li>Always notify</li><li>Notify only when apps try to change settings, use the secure desktop <code>(Default mode)</code></li><li>Notify only when apps try to change settings, don’t use the secure desktop</li><li>Never notify</li></ul><p>Although it looks like there are four settings, in a theoretical sense, there really are only two settings.</p><ul><li>Always notify</li><li>Meh</li></ul><p>The reason why all the other options collapse into Meh is that the <code>Notify only when apps try to change settings</code> option can be subverted by any app simply by injecting a thread into (...)</p></blockquote><p>And, up to this day, Windows 10 &amp; 11, defaults to &quot;Meh&quot;. Microsoft default is: lesser security in exchange of user convenience. </p><hr><p><img loading="lazy" alt="Vista UAC" src="/gsudo/assets/images/Vista-UAC-46f068593f9c4fad89a7ad1bace9b983.png" width="1122" height="831" class="img_ev3q">
<!-- -->[Windows 11 UAC Settings: Default mode is recommended only if you <strong>don&#x27;t</strong> run untrusted software.]</p><hr><p>Over time, no less than a hundred UAC-bypass techniques were disclosed. Many of them still work in an updated Windows 11. Windows Defender, or your antivirus of choice, will stop them (hopefully). But if you disable your AV, UAC bypass is easy. </p><p>And Microsoft did not patch them. Instead, it was assumed publicly that <code>UAC/UIPI</code> in default mode is not a security boundary. I will <a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/windows-security/disable-user-account-control#:~:text=More%20important%2C%20Same%2Ddesktop%20Elevation,be%20considered%20a%20convenience%20feature." target="_blank" rel="noopener noreferrer">quote Microsoft documentation</a> :</p><blockquote><p>Same-desktop Elevation in UAC isn&#x27;t a security boundary. It can be hijacked by unprivileged software that runs on the same desktop. Same-desktop Elevation should be considered a convenience feature.</p></blockquote><p>This literally means: <b>UAC does not protect you from threats. It&#x27;s a convenience tool that protects you from shooting yourself in the foot. </b></p><p>And, in my opinion, it&#x27;s not doing a great job:</p><ul><li>You waste important time by switching between elevated and unelevated windows. You have to manually carry your command and context to the elevated window, each time.</li><li>... or you suffer from &quot;elevation fatigue&quot;. For example, you elevate a whole console beforehand, or all of them, and you do all your stuff there, likely running non-admin or untrusted stuff as admin, even when you shouldn&#x27;t.</li></ul><p>The premises on which I assume they decided not to create a Windows <code>sudo</code> are false.</p><p>Same-desktop UAC is a convenience feature, and so is <code>gsudo</code>. <strong>In -<em>any</em>- case, the only thing that protects you from malware is you and your AntiVirus.</strong>.</p><p>Therefore, in my opinion, <strong>the best way to not shoot yourself in the foot is to use a <code>sudo</code> tool</strong> that allows you to easily cherry-pick the exact commands to elevate and minimizes the time-waste and &quot;elevation fatigue&quot;.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-the-risks-of-running-gsudo">What are the risks of running gsudo?<a class="hash-link" href="#what-are-the-risks-of-running-gsudo" title="Direct link to heading">​</a></h2><p>gsudo could be used as an attack vector for escalation of privileges:</p><ul><li><p><strong>Abusing an elevation made with gsudo:</strong> A medium integrity process could drive the gsudo-elevated process: </p><p>When gsudo elevates <strong>in the same console</strong>, it creates a connection between a medium and a high integrity process. A malicious process (at medium integrity) can then drive the medium integrity console: sending keystrokes to the high integrity app, or scrapping its screen.</p><p>In my opinion, this is a mild risk that you are already exposed when using UAC in default mode. In the end, your only protection is your AV.</p><p>Ways to avoid this risk:</p><ul><li>Elevating on a new console, using <code>-n</code>/<code>--new</code>. </li><li>Proposed new feature <code>ForceNewWindow</code>, to add a config setting where all elevations are done in new windows, so no isolation is broken. Tracked here: <a href="https://github.com/gerardog/gsudo/issues/97" target="_blank" rel="noopener noreferrer">#97</a> (and up for grabs)</li><li>Experimental: <code>SecurityEnforceUacIsolation</code>
makes the elevated command run redirected, w/input redirected to <code>NULL</code>. Hence it will be non-interactive, so nobody will be able to drive it. Enable with <code>gsudo config SecurityEnforceUacIsolation true</code></li></ul></li><li><p><strong>Abusing an active <code>gsudo Credentials Cache</code> to elevate a process silently</strong>:</p><p> The <code>Credentials Cache</code> allows many elevations with only one UAC popup. But there is a reason why the cache is disabled by default.</p><p> When the cache is active, it allows elevation from one invoker process and its children, which are running at the unprotected medium integrity level. A malicious process also at medium level can inject it&#x27;s code into an allowed process and make it call gsudo to request elevation silently.</p><p> You avoid this risk by default, by not enabling the credentials cache. </p></li></ul><p><strong>TLDR;</strong>  <code>UAC</code> and <code>gsudo</code> are both vulnerable convenience features. Both rely on your ability to avoid malware, or your antivirus ability to stop it.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gerardog/gsudo/blob/docs/docs/docs/security.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/gsudo/docs/credentials-cache"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Credentials Cache</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/gsudo/docs/how-it-works"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How it works</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-windows-doesnt-have-a-sudo-command" class="table-of-contents__link toc-highlight">Why Windows doesn&#39;t have a <code>sudo</code> command?</a></li><li><a href="#what-are-the-risks-of-running-gsudo" class="table-of-contents__link toc-highlight">What are the risks of running gsudo?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/gsudo/docs/intro">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/dEEA3P5WqF" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/gerardog/gsudo/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an Issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/gerardo_gr" target="_blank" rel="noopener noreferrer" class="footer__link-item">Follow me on Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/gsudo/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/gerardog/gsudo" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Gerardo Grignoli. Built with Docusaurus.</div></div></div></footer></div>
<script src="/gsudo/assets/js/runtime~main.743845d5.js"></script>
<script src="/gsudo/assets/js/main.4cd861a1.js"></script>
</body>
</html>